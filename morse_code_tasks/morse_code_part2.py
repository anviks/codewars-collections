"""https://www.codewars.com/kata/decode-the-morse-code-advanced"""

from morse import MORSE_CODE


def decode_bits(bits: str):
    bits = bits.strip("0")

    consecutive_bit_counts = []
    consecutive_count = 0
    previous_bit = bits[0]

    for bit in bits:
        if bit == previous_bit:
            consecutive_count += 1
        else:
            consecutive_bit_counts.append(consecutive_count)
            consecutive_count = 1
        previous_bit = bit
    consecutive_bit_counts.append(consecutive_count)

    bits_per_dot = min(consecutive_bit_counts)

    return bits.replace('0000000' * bits_per_dot, "   ")\
        .replace('111' * bits_per_dot, '-')\
        .replace('000' * bits_per_dot, ' ')\
        .replace('1' * bits_per_dot, '.')\
        .replace('0' * bits_per_dot, '')


def decode_morse(morse_code):
    return " ".join(["".join([MORSE_CODE[letter] for letter in word.split(" ")]) for word in morse_code.split("   ")]).strip()


if __name__ == '__main__':
    print("Example from description")
    print(decode_morse(decode_bits(
        "1100110011001100000011000000111111001100111111001111110000000000000011001111110011111100111111000000110011"
        "001111110000001111110011001100000011"
    )))
    # HEY JUDE

    print("\nBasic bits decoding:")
    print(decode_morse(decode_bits("1")))  # E
    print(decode_morse(decode_bits("101")))  # I
    print(decode_morse(decode_bits("10001")))  # EE
    print(decode_morse(decode_bits("10111")))  # A
    print(decode_morse(decode_bits("1110111")))  # M

    print("\nMultiple bits per dot handling:")
    print(decode_morse(decode_bits("111")))  # E
    print(decode_morse(decode_bits("1111111")))  # E
    print(decode_morse(decode_bits("110011")))  # I
    print(decode_morse(decode_bits("111000111")))  # I
    print(decode_morse(decode_bits("111110000011111")))  # I
    print(decode_morse(decode_bits("111000000000111")))  # EE
    print(decode_morse(decode_bits("11111100111111")))  # M
    print(decode_morse(decode_bits("111000111000111")))  # S
    print(decode_morse(decode_bits(
        "111111000000111111000000111111000000111111000000000000000000111111000000000000000000111111111111111111000000"
        "111111000000111111111111111111000000111111111111111111000000000000000000000000000000000000000000111111000000"
        "111111111111111111000000111111111111111111000000111111111111111111000000000000000000111111000000111111000000"
        "111111111111111111000000000000000000111111111111111111000000111111000000111111000000000000000000111111"
    )))
    # HEY JUDE

    print("\nExtra zeros handling:")
    print(decode_morse(decode_bits("01110")))  # E
    print(decode_morse(decode_bits("000000011100000")))  # E

    print("\nLong messages handling:")
    print(decode_morse(decode_bits(
        "000111000101010100010000000111011101011100010101110001010001110101110100011101011100000001110101010001011101"
        "000111011101110001011101110001110100000001010111010001110111011100011101010111000000010111011101110001010111"
        "000111011100010111011101000101010000000111011101110001010101110001000101110100000001110001010101000100000001"
        "01110101000101110001110111010100011101011101110000000111010100011101110111000111011101000101110101110101110"
    )))
    # THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG.
    print(decode_morse(decode_bits(
        "111111111111111000000000000000111110000011111000001111100000111110000000000000001111100000000000000000000000"
        "000000000000111111111111111000001111111111111110000011111000001111111111111110000000000000001111100000111110"
        "000011111111111111100000000000000011111000001111100000000000000011111111111111100000111110000011111111111111"
        "100000111110000000000000001111111111111110000011111000001111111111111110000000000000000000000000000000000011"
        "111111111111100000111110000011111000001111100000000000000011111000001111111111111110000011111000000000000000"
        "111111111111111000001111111111111110000011111111111111100000000000000011111000001111111111111110000011111111"
        "111111100000000000000011111111111111100000111110000000000000000000000000000000000011111000001111100000111111"
        "111111111000001111100000000000000011111111111111100000111111111111111000001111111111111110000000000000001111"
        "111111111110000011111000001111100000111111111111111000000000000000000000000000000000001111100000111111111111"
        "111000001111111111111110000011111111111111100000000000000011111000001111100000111111111111111000000000000000"
        "111111111111111000001111111111111110000000000000001111100000111111111111111000001111111111111110000011111000"
        "000000000000111110000011111000001111100000000000000000000000000000000000111111111111111000001111111111111110"
        "000011111111111111100000000000000011111000001111100000111110000011111111111111100000000000000011111000000000"
        "000000111110000011111111111111100000111110000000000000000000000000000000000011111111111111100000000000000011"
        "111000001111100000111110000011111000000000000000111110000000000000000000000000000000000011111000001111111111"
        "111110000011111000001111100000000000000011111000001111111111111110000000000000001111111111111110000011111111"
        "111111100000111110000011111000000000000000111111111111111000001111100000111111111111111000001111111111111110"
        "000000000000000000000000000000000011111111111111100000111110000011111000000000000000111111111111111000001111"
        "111111111110000011111111111111100000000000000011111111111111100000111111111111111000001111100000000000000011"
        "11100000111111111111111000001111100000111111111111111000001111100000111111111111111"
    )))
    # THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG.
